<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Binary Exploits 2 | CTF Field Guide</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="trailofbits">
        <meta name="description" content="“Knowing is not enough; we must apply. Willing is not enough; we must do.” - Johann Wolfgang von Goethe">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../web/exploits.html" />
        
        
        <link rel="prev" href="../exploits/binary1.html" />
        

        <meta property="og:title" content="Binary Exploits 2 | CTF Field Guide">
        <meta property="og:site_name" content="CTF Field Guide">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/trailofbits">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="trailofbits/ctf" data-level="3.2" data-basepath=".." data-revision="1400546870522">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/trailofbits/ctf" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/trailofbits/ctf/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/trailofbits/ctf/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >CTF Field Guide</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/trailofbits" target="blank" class="author-link">About the author</a>
        </li>
        

        
        <li>
            <a href="https://github.com/trailofbits/ctf/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        <li>
            <a href="https://github.com/trailofbits/ctf/edit/master/exploits/binary2.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li class="chapter " data-level="1" data-path="ctf.html">
                
                <a href="../ctf.html">
                    <i class="fa fa-check"></i> <b>1.</b> Capture the Flag
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="2" data-path="vulnerabilities/README.html">
                
                <a href="../vulnerabilities/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Vulnerability Discovery
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="vulnerabilities/source.html">
                            
                            <a href="../vulnerabilities/source.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Auditing Source
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="vulnerabilities/binary.html">
                            
                            <a href="../vulnerabilities/binary.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Auditing Binaries
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="web/vulnerabilities.html">
                            
                            <a href="../web/vulnerabilities.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Auditing Webapps
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="3" data-path="exploits/README.html">
                
                <a href="../exploits/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Exploit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="exploits/binary1.html">
                            
                            <a href="../exploits/binary1.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Binary Exploits 1
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="exploits/binary2.html">
                            
                            <a href="../exploits/binary2.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Binary Exploits 2
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="web/exploits.html">
                            
                            <a href="../web/exploits.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Webapp Exploits
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="4" data-path="forensics/README.html">
                
                <a href="../forensics/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> Forensics
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="5" data-path="toolkits/README.html">
                
                <a href="../toolkits/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Toolkit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="toolkits/prep.html">
                            
                            <a href="../toolkits/prep.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Toolkit Prep
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="6" data-path="tradecraft/README.html">
                
                <a href="../tradecraft/README.html">
                    <i class="fa fa-check"></i> <b>6.</b> Operational Tradecraft
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="6.1" data-path="tradecraft/case_studies.html">
                            
                            <a href="../tradecraft/case_studies.html">
                                <i class="fa fa-check"></i> <b>6.1.</b> Case Studies
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="7" data-path="contrib/README.html">
                
                <a href="../contrib/README.html">
                    <i class="fa fa-check"></i> <b>7.</b> Contributors
                </a>
                
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 53.333333333333336%;min-width: 46.666666666666664%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../ctf.html" title="Capture the Flag" class="chapter done new-chapter" data-progress="1" style="left: 6.666666666666667%;"></a>
    
        <a href="../vulnerabilities/README.html" title="Vulnerability Discovery" class="chapter done new-chapter" data-progress="2" style="left: 13.333333333333334%;"></a>
    
        <a href="../vulnerabilities/source.html" title="Auditing Source" class="chapter done " data-progress="2.1" style="left: 20%;"></a>
    
        <a href="../vulnerabilities/binary.html" title="Auditing Binaries" class="chapter done " data-progress="2.2" style="left: 26.666666666666668%;"></a>
    
        <a href="../web/vulnerabilities.html" title="Auditing Webapps" class="chapter done " data-progress="2.3" style="left: 33.333333333333336%;"></a>
    
        <a href="../exploits/README.html" title="Exploit Creation" class="chapter done new-chapter" data-progress="3" style="left: 40%;"></a>
    
        <a href="../exploits/binary1.html" title="Binary Exploits 1" class="chapter done " data-progress="3.1" style="left: 46.666666666666664%;"></a>
    
        <a href="../exploits/binary2.html" title="Binary Exploits 2" class="chapter done " data-progress="3.2" style="left: 53.333333333333336%;"></a>
    
        <a href="../web/exploits.html" title="Webapp Exploits" class="chapter  " data-progress="3.3" style="left: 60%;"></a>
    
        <a href="../forensics/README.html" title="Forensics" class="chapter  new-chapter" data-progress="4" style="left: 66.66666666666667%;"></a>
    
        <a href="../toolkits/README.html" title="Toolkit Creation" class="chapter  new-chapter" data-progress="5" style="left: 73.33333333333333%;"></a>
    
        <a href="../toolkits/prep.html" title="Toolkit Prep" class="chapter  " data-progress="5.1" style="left: 80%;"></a>
    
        <a href="../tradecraft/README.html" title="Operational Tradecraft" class="chapter  new-chapter" data-progress="6" style="left: 86.66666666666667%;"></a>
    
        <a href="../tradecraft/case_studies.html" title="Case Studies" class="chapter  " data-progress="6.1" style="left: 93.33333333333333%;"></a>
    
        <a href="../contrib/README.html" title="Contributors" class="chapter  new-chapter" data-progress="7" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_16">
                    
                        <h1 id="exploiting-binaries-2">Exploiting Binaries 2</h1>
<p>In this module, we continue to examine the ways that native applications can be exploited and focus on using return-oriented programming (ROP) to achieve that goal. ROP is the process of stitching together existing executable fragments of code ending in a return instruction. By creating chains of addresses of these ‘gadgets’ one can write new programs without introducing any new code.</p>
<p>Keep in mind that you will need to be flexible in identifying methods to exploit programs. Sometimes it’s necessary to abuse a vulnerability multiple times in the course of an exploit. At times, you may only want to use a ROP bridge to make your shellcode executable and, at others, you may want to use a payload written entirely in ROP. Occasionally, the layout of memory makes unorthodox methods of exploitation favorable. For example, have you considered manufacturing an uncontrolled format string vulnerability using ROP?</p>
<h2 id="lecture">Lecture</h2>
<p>The lectures this week will discuss return oriented programming (ROP) and code reuse to bypass protections that disallow the execution of attacker-provided data. These lectures go into much greater detail on exploitation and build upon some of what was discussed last week.</p>
<ul>
<li><a href="http://vimeo.com/54941772" target="_blank">Return Oriented Exploitation</a></li>
<li><a href="http://www.youtube.com/watch?v=GIZziAOniBE" target="_blank">Payload already inside data re-use for ROP exploits</a> (Linux-specific)</li>
</ul>
<h2 id="workshop">Workshop</h2>
<p>Similar to the previous lesson, there are two executable files located in this folder when you clone the repository. Exploits for each of these programs will require the use of return-oriented programming to read the flags. This week, there is no access to source code provided. You will need to reverse engineer the binaries to discovery the vulnerabilities and the techniques required to exploit them. Use the same Ubuntu 14.04 (32-bit) virtual machine as the previous lesson.</p>
<h3 id="challenge-brute_cookie">Challenge: brute_cookie</h3>
<p>Run the <code>bc</code> program. It will listen on port <code>12345</code>.</p>
<h3 id="challenge-space">Challenge: space</h3>
<p>Run <code>host.sh</code>  in the same directory as the <code>space</code> program. It will listen on port <code>12348</code>.</p>
<h3 id="challenge-rop_mixer">Challenge: rop_mixer</h3>
<p>Run <code>host.sh</code> in the same directory as the <code>rop_mixer</code> program. It will listen on port <code>12349</code>.</p>
<h2 id="tools">Tools</h2>
<p>Refer to the tools from last week. If you haven&#39;t already, you should become familiar with the <code>binutils</code> suite for *NIX. Tools like <code>readelf</code>, <code>strings</code>, <code>objdump</code>, <code>objcopy</code>, and <code>nm</code> are frequently helpful. Use your package manager and the manpages to install and read about their use.</p>
<p>Several tools exist to aid specifically in the creation of exploits that reuse code. They are more specialized than a standard disassembler because they look for executable snippets of code suitable as ROP gadgets (between instructions, in .rodata, etc).</p>
<ul>
<li><a href="https://github.com/0vercl0k/rp" target="_blank">RP</a></li>
<li><a href="https://github.com/JonathanSalwan/ROPgadget" target="_blank">ROPGadget</a></li>
<li><a href="https://github.com/trailofbits/bisc/" target="_blank">BISC</a> - Simple tool covered in the lecture</li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="/ctf/exploits/references/no-nx.pdf">x86-64 buffer overflow exploits and the borrowed code chunks exploitation technique</a></li>
<li><a href="/ctf/exploits/references/acsac09.pdf">Surgically returning to randomized lib(c)</a></li>
<li><a href="https://code.google.com/p/it-sec-catalog/wiki/Exploitation" target="_blank">Extensive security reference</a></li>
<li><a href="http://althing.cs.dartmouth.edu/secref/resources/buffer_overflows.shtml" target="_blank">Dartmouth College: Useful Security and Privacy links</a></li>
<li><a href="https://www.corelan.be/index.php/articles/" target="_blank">Corelan Team Blog</a></li>
</ul>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../exploits/binary1.html" class="navigation navigation-prev " aria-label="Previous page: Binary Exploits 1"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../web/exploits.html" class="navigation navigation-next " aria-label="Next page: Webapp Exploits"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"ga":{"token":"UA-37017099-3"}};
    gitbook.start(config);
});
</script>

    </body>
</html>
