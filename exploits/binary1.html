<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        
        <meta charset="UTF-8">
        <title>Binary Exploits 1 | CTF Field Guide</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="trailofbits">
        <meta name="description" content="“Knowing is not enough; we must apply. Willing is not enough; we must do.” - Johann Wolfgang von Goethe">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../exploits/binary2.html" />
        
        
        <link rel="prev" href="../exploits/README.html" />
        

        <meta property="og:title" content="Binary Exploits 1 | CTF Field Guide">
        <meta property="og:site_name" content="CTF Field Guide">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/trailofbits">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
        
    </head>
    <body>
        
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="trailofbits/ctf" data-level="3.1" data-basepath=".." data-revision="1400971917432">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/trailofbits/ctf" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/trailofbits/ctf/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/trailofbits/ctf/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >CTF Field Guide</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/trailofbits" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/trailofbits/ctf/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/trailofbits/ctf/edit/master/exploits/binary1.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li class="chapter " data-level="1" data-path="ctf.html">
                
                <a href="../ctf.html">
                    <i class="fa fa-check"></i> <b>1.</b> Capture the Flag
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="2" data-path="vulnerabilities/README.html">
                
                <a href="../vulnerabilities/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Vulnerability Discovery
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="vulnerabilities/source.html">
                            
                            <a href="../vulnerabilities/source.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Auditing Source
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="vulnerabilities/binary.html">
                            
                            <a href="../vulnerabilities/binary.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Auditing Binaries
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="web/vulnerabilities.html">
                            
                            <a href="../web/vulnerabilities.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Auditing Webapps
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="3" data-path="exploits/README.html">
                
                <a href="../exploits/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Exploit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="exploits/binary1.html">
                            
                            <a href="../exploits/binary1.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Binary Exploits 1
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="exploits/binary2.html">
                            
                            <a href="../exploits/binary2.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Binary Exploits 2
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="web/exploits.html">
                            
                            <a href="../web/exploits.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Webapp Exploits
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="4" data-path="forensics/README.html">
                
                <a href="../forensics/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> Forensics
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="5" data-path="toolkits/README.html">
                
                <a href="../toolkits/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Toolkit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="toolkits/prep.html">
                            
                            <a href="../toolkits/prep.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Toolkit Prep
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="6" data-path="tradecraft/README.html">
                
                <a href="../tradecraft/README.html">
                    <i class="fa fa-check"></i> <b>6.</b> Operational Tradecraft
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="6.1" data-path="tradecraft/case_studies.html">
                            
                            <a href="../tradecraft/case_studies.html">
                                <i class="fa fa-check"></i> <b>6.1.</b> Case Studies
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="7" data-path="contrib.html">
                
                <a href="../contrib.html">
                    <i class="fa fa-check"></i> <b>7.</b> Contributors
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="8" data-path="appendix.html">
                
                <a href="../appendix.html">
                    <i class="fa fa-check"></i> <b>8.</b> Appendix
                </a>
                
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 43.75%;min-width: 37.5%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../ctf.html" title="Capture the Flag" class="chapter done new-chapter" data-progress="1" style="left: 6.25%;"></a>
    
        <a href="../vulnerabilities/README.html" title="Vulnerability Discovery" class="chapter done new-chapter" data-progress="2" style="left: 12.5%;"></a>
    
        <a href="../vulnerabilities/source.html" title="Auditing Source" class="chapter done " data-progress="2.1" style="left: 18.75%;"></a>
    
        <a href="../vulnerabilities/binary.html" title="Auditing Binaries" class="chapter done " data-progress="2.2" style="left: 25%;"></a>
    
        <a href="../web/vulnerabilities.html" title="Auditing Webapps" class="chapter done " data-progress="2.3" style="left: 31.25%;"></a>
    
        <a href="../exploits/README.html" title="Exploit Creation" class="chapter done new-chapter" data-progress="3" style="left: 37.5%;"></a>
    
        <a href="../exploits/binary1.html" title="Binary Exploits 1" class="chapter done " data-progress="3.1" style="left: 43.75%;"></a>
    
        <a href="../exploits/binary2.html" title="Binary Exploits 2" class="chapter  " data-progress="3.2" style="left: 50%;"></a>
    
        <a href="../web/exploits.html" title="Webapp Exploits" class="chapter  " data-progress="3.3" style="left: 56.25%;"></a>
    
        <a href="../forensics/README.html" title="Forensics" class="chapter  new-chapter" data-progress="4" style="left: 62.5%;"></a>
    
        <a href="../toolkits/README.html" title="Toolkit Creation" class="chapter  new-chapter" data-progress="5" style="left: 68.75%;"></a>
    
        <a href="../toolkits/prep.html" title="Toolkit Prep" class="chapter  " data-progress="5.1" style="left: 75%;"></a>
    
        <a href="../tradecraft/README.html" title="Operational Tradecraft" class="chapter  new-chapter" data-progress="6" style="left: 81.25%;"></a>
    
        <a href="../tradecraft/case_studies.html" title="Case Studies" class="chapter  " data-progress="6.1" style="left: 87.5%;"></a>
    
        <a href="../contrib.html" title="Contributors" class="chapter  new-chapter" data-progress="7" style="left: 93.75%;"></a>
    
        <a href="../appendix.html" title="Appendix" class="chapter  new-chapter" data-progress="8" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_7">
                    
                        <h1 id="exploiting-binaries-1">Exploiting Binaries 1</h1>
<p>Binary exploitation is the process of subverting a compiled application such that it violates some trust boundary in a way that is advantageous to you, the attacker. In this module we are going to focus on memory corruption. By abusing vulnerabilities that corrupt memory in software we can often rewrite critical application state information in a way that allows us to elevate privileges inside the context of a particular application (like a remote desktop server) or perform arbitrary computation by hijacking control flow and running code of our choosing.</p>
<p>If you&#39;re trying to find bugs in compiled C programs, it&#39;s important to know what you&#39;re looking for. Start with identifying where the data you send to the program is used. If your data is stored in a buffer, take note of the sizes of them. Programming in C without errors is very difficult and the <a href="https://www.securecoding.cert.org/confluence/display/seccode/CERT+C+Coding+Standard" target="_blank">CERT C Coding Standard</a> catalogues many of the ways that errors can come about. Paying attention to <a href="http://stackoverflow.com/questions/4588581/which-functions-in-the-c-standard-library-commonly-encourage-bad-practice" target="_blank">commonly misused APIs</a> can be a quick path to success.</p>
<p>Once a vulnerability is identified it should be used to compromise the integrity of the program, however, there are a variety of ways to achieve this goal. For programs such as web servers, obtaining the information from another user may be the end goal. In others, changing your permissions may be helpful, for example changing the permissions of a local user to the administrator.</p>
<h2 id="lecture">Lecture</h2>
<p>The first lecture, Memory Corruption 101, provides background and step-by-step explanation of exploiting an overflow on Windows. The second lecture, Memory Corruption 102, covers more advanced topics, including web browser exploitation. Both of these lectures use Windows-specific examples but the techniques and process are applicable across operating systems that use the x86 instruction set. Remember that the names of functions and sometimes the calling conventions will be different when you are working with UNIX/Linux binaries.</p>
<ul>
<li><a href="http://vimeo.com/31348274" target="_blank">Memory Corruption 101</a></li>
<li><a href="http://vimeo.com/31831062" target="_blank">Memory Corruption 102</a></li>
</ul>
<h2 id="tools">Tools</h2>
<p>We recommend using GDB to debug the challenges in this module since all of them are compiled for 32-bit Linux, however, GDB is intended for debugging source code, not stripped binaries without symbols and debugging information. Projects such as <a href="https://github.com/gdbinit/gdbinit" target="_blank">gdbinit</a>, <a href="https://code.google.com/p/peda/" target="_blank">peda</a>, and <a href="https://github.com/snarez/voltron" target="_blank">voltron</a> are attempts at making gdb more useful for debugging when source code is not available.  We recommend making a <code>.gdbinit</code> file in your home directory with at least the following commands:</p>
<pre><code>    set disassembly-flavor intel
    set follow-fork-mode child
</code></pre><h2 id="workshop">Workshop</h2>
<p>In order to run these challenges, you&#39;ll need to setup an <a href="http://www.ubuntu.com/download/desktop/thank-you?country=US&amp;version=14.04&amp;architecture=i386" target="_blank">Ubuntu 14.04 (32-bit)</a> virtual machine. We recommend using <a href="https://my.vmware.com/web/vmware/free#desktop_end_user_computing/vmware_player/6_0" target="_blank">VMware Player</a>, since it&#39;s free and well supported. When you have it running, open a terminal and install <code>socat</code> with command <code>sudo apt-get install socat</code>.</p>
<p>There are three challenges in this workshop, each contained within this folder when you clone this repository in git. The ultimate goal of each challenge is to manipulate the executable into reading the flag to you. For each challenge, try to translate the disassembly into C code. After making an attempt, you can verify your guess by checking the actual C source provided. Then, try to exploit it to read you the flag.</p>
<h3 id="challenge-easy">Challenge: Easy</h3>
<p>Make sure the flag is in the same directory as the <code>easy</code> program. Once you execute <code>easy</code> it will listen for instructions on port <code>12346</code>.</p>
<h3 id="challenge-social">Challenge: Social</h3>
<p>Similar to easy, make sure the flag and <code>host.sh</code> are in the same directory as <code>social</code> program. Once you execute <code>social</code> it will listen for instructions on port <code>12347</code>.</p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="http://www.exploit-db.com/papers/13205/" target="_blank">Using GDB to Develop Exploits - A Basic Run Through</a></li>
<li><a href="/ctf/exploits/references/formatstring-1.2.pdf">Exploiting Format String Vulnerabilities</a></li>
<li><a href="/ctf/exploits/references/tr-2007-153.pdf">Low-level Software Security: Attacks and Defenses</a></li>
</ul>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../exploits/README.html" class="navigation navigation-prev " aria-label="Previous page: Exploit Creation"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../exploits/binary2.html" class="navigation navigation-next " aria-label="Next page: Binary Exploits 2"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"ga":{"token":"UA-37017099-3"},"fontSettings":{"theme":"night"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
