<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Auditing Binaries | CTF Field Guide</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="trailofbits">
        <meta name="description" content="“Knowing is not enough; we must apply. Willing is not enough; we must do.” - Johann Wolfgang von Goethe">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../web/vulnerabilities.html" />
        
        
        <link rel="prev" href="../vulnerabilities/source.html" />
        

        <meta property="og:title" content="Auditing Binaries | CTF Field Guide">
        <meta property="og:site_name" content="CTF Field Guide">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/trailofbits">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="trailofbits/ctf" data-level="2.2" data-basepath=".." data-revision="1400546870522">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/trailofbits/ctf" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/trailofbits/ctf/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/trailofbits/ctf/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >CTF Field Guide</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/trailofbits" target="blank" class="author-link">About the author</a>
        </li>
        

        
        <li>
            <a href="https://github.com/trailofbits/ctf/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        <li>
            <a href="https://github.com/trailofbits/ctf/edit/master/vulnerabilities/binary.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li class="chapter " data-level="1" data-path="ctf.html">
                
                <a href="../ctf.html">
                    <i class="fa fa-check"></i> <b>1.</b> Capture the Flag
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="2" data-path="vulnerabilities/README.html">
                
                <a href="../vulnerabilities/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Vulnerability Discovery
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="vulnerabilities/source.html">
                            
                            <a href="../vulnerabilities/source.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Auditing Source
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="vulnerabilities/binary.html">
                            
                            <a href="../vulnerabilities/binary.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Auditing Binaries
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="web/vulnerabilities.html">
                            
                            <a href="../web/vulnerabilities.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Auditing Webapps
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="3" data-path="exploits/README.html">
                
                <a href="../exploits/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Exploit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="exploits/binary1.html">
                            
                            <a href="../exploits/binary1.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Binary Exploits 1
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="exploits/binary2.html">
                            
                            <a href="../exploits/binary2.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Binary Exploits 2
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="web/exploits.html">
                            
                            <a href="../web/exploits.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Webapp Exploits
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="4" data-path="forensics/README.html">
                
                <a href="../forensics/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> Forensics
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="5" data-path="toolkits/README.html">
                
                <a href="../toolkits/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Toolkit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="toolkits/prep.html">
                            
                            <a href="../toolkits/prep.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Toolkit Prep
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="6" data-path="tradecraft/README.html">
                
                <a href="../tradecraft/README.html">
                    <i class="fa fa-check"></i> <b>6.</b> Operational Tradecraft
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="6.1" data-path="tradecraft/case_studies.html">
                            
                            <a href="../tradecraft/case_studies.html">
                                <i class="fa fa-check"></i> <b>6.1.</b> Case Studies
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="7" data-path="contrib/README.html">
                
                <a href="../contrib/README.html">
                    <i class="fa fa-check"></i> <b>7.</b> Contributors
                </a>
                
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 26.666666666666668%;min-width: 20%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../ctf.html" title="Capture the Flag" class="chapter done new-chapter" data-progress="1" style="left: 6.666666666666667%;"></a>
    
        <a href="../vulnerabilities/README.html" title="Vulnerability Discovery" class="chapter done new-chapter" data-progress="2" style="left: 13.333333333333334%;"></a>
    
        <a href="../vulnerabilities/source.html" title="Auditing Source" class="chapter done " data-progress="2.1" style="left: 20%;"></a>
    
        <a href="../vulnerabilities/binary.html" title="Auditing Binaries" class="chapter done " data-progress="2.2" style="left: 26.666666666666668%;"></a>
    
        <a href="../web/vulnerabilities.html" title="Auditing Webapps" class="chapter  " data-progress="2.3" style="left: 33.333333333333336%;"></a>
    
        <a href="../exploits/README.html" title="Exploit Creation" class="chapter  new-chapter" data-progress="3" style="left: 40%;"></a>
    
        <a href="../exploits/binary1.html" title="Binary Exploits 1" class="chapter  " data-progress="3.1" style="left: 46.666666666666664%;"></a>
    
        <a href="../exploits/binary2.html" title="Binary Exploits 2" class="chapter  " data-progress="3.2" style="left: 53.333333333333336%;"></a>
    
        <a href="../web/exploits.html" title="Webapp Exploits" class="chapter  " data-progress="3.3" style="left: 60%;"></a>
    
        <a href="../forensics/README.html" title="Forensics" class="chapter  new-chapter" data-progress="4" style="left: 66.66666666666667%;"></a>
    
        <a href="../toolkits/README.html" title="Toolkit Creation" class="chapter  new-chapter" data-progress="5" style="left: 73.33333333333333%;"></a>
    
        <a href="../toolkits/prep.html" title="Toolkit Prep" class="chapter  " data-progress="5.1" style="left: 80%;"></a>
    
        <a href="../tradecraft/README.html" title="Operational Tradecraft" class="chapter  new-chapter" data-progress="6" style="left: 86.66666666666667%;"></a>
    
        <a href="../tradecraft/case_studies.html" title="Case Studies" class="chapter  " data-progress="6.1" style="left: 93.33333333333333%;"></a>
    
        <a href="../contrib/README.html" title="Contributors" class="chapter  new-chapter" data-progress="7" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_12">
                    
                        <h1 id="auditing-binaries">Auditing Binaries</h1>
<p>You’ve made it all the way down to the native layer, this is what software is after you pull off all the covers. The flavor of native code we’re going to focus on today is 32-bit Intel x86. Intel processors have been a powerful force in personal computing since the 80’s and currently predominate desktop and server market. Understanding this instruction set will give you some insight into how the programs you use every day operate as well as provide a reference point for when you encounter other instruction sets like ARM, MIPS, PowerPC and SPARC.</p>
<p>This module is about becoming familiar with the native layer and developing strategies for understanding, analyzing and interpreting native code. By the end of this module you should be capable of performing a “reverse compilation” -- going from assembly fragments to statements in higher level languages -- and, in the process, deriving meaning and programmer intent.</p>
<h2 id="lecture">Lecture</h2>
<p>Learning x86 can appear daunting at first and requires some dedicated study to master. We recommend reading Chapter 3 of &quot;Computer Systems: A Programmer&#39;s Perspective&quot; to learn how C programs get compiled into machine code. Once you you have some basic, working knowledge of this process then keep a handy reference guide around like the x86 Assembly Guide from the University of Virginia. We&#39;ve found this video series from Quinn Liu to be a quick and painless introduction too.</p>
<ul>
<li>CS:APP Chapter 3: <a href="https://picoctf.com/docs/asmhandout.pdf" target="_blank">Machine-Level Representation of Programs</a></li>
<li><a href="http://www.cs.virginia.edu/~evans/cs216/guides/x86.html" target="_blank">x86 Assembly Guide</a></li>
<li><a href="https://www.youtube.com/watch?v=qn1_dRjM6F0&amp;list=PLPXsMt57rLthf58PFYE9gOAsuyvs7T5W9" target="_blank">Introduction to x86 Assembly</a></li>
</ul>
<h2 id="workshop">Workshop</h2>
<p>The following programs are both “binary bombs.” Reverse engineer the following linux programs to identify the series of inputs that will “defuse” the bomb. Each successive level of the bomb focuses on a different aspect of native code. For example, in the lab from CMU you will encounter different data structures (linked lists, trees) as well as how control flow structures (switches, loops) manifest in native code. While reversing these programs you may find it useful to keep track of your progress by transforming what you see into C or another high level language.</p>
<p>You should aim to solve at least eight stages between the two labs. The CMU bomb lab has a secret phase and the RPI bomb lab has a phase that involves memory corruption, can you find and solve them?</p>
<ul>
<li><a href="http://csapp.cs.cmu.edu/public/bomb.tar" target="_blank">CMU Binary Bomb Lab</a></li>
<li><a href="http://www.cs.rpi.edu/academics/courses/spring10/csci4971/rev2/bomb" target="_blank">RPI Binary Bomb Lab</a></li>
</ul>
<h2 id="tools">Tools</h2>
<p>The two essential tools for working with native code are the debugger and the disassembler. We recommend you become familiar with the industry standard disassembler: IDA Pro. IDA will divide code into discrete chunks corresponding to the functions defined in the program&#39;s source code. Each function is then further subdivided into &quot;basic blocks&quot; defined by instructions that alter control flow. This makes it easy to identify loops, conditionals, and other control flow constructs at a glance.</p>
<p>Debuggers allow you to interact with and examine the state of running code by setting breakpoints and examining memory and register contents. You may find this useful as a sanity check if you are not seeing the results you expect your input to produce but be alert, some programs employ anti-debugger techniques and can modify program behavior in the presence of a debugger. The GNU Debugger (gdb) is the standard debugger for most linux systems. gdb can be acquired through the package manager in your chosen linux distribution.</p>
<ul>
<li><a href="https://www.hex-rays.com/products/ida/support/download_demo.shtml" target="_blank">IDA Pro Demo</a></li>
<li><a href="http://www.sourceware.org/gdb/" target="_blank">gdb</a></li>
</ul>
<h2 id="resources">Resources</h2>
<p>Many good resources exist for learning x86 assembly and the various tricks employed in capture the flag exercises. In addition to the resources above, the x86 Wikibook and the AMD instruction set manual are more complete reference guides you may want to refer to (we find the AMD manual can be less daunting than the corresponding manual from Intel).</p>
<ul>
<li>AMD64 Programmer&#39;s Manual: <a href="http://amd-dev.wpengine.netdna-cdn.com/wordpress/media/2008/10/24594_APM_v3.pdf" target="_blank">General-Purpose and System Instructions</a></li>
<li><a href="https://en.wikibooks.org/wiki/X86_Assembly" target="_blank">x86 Assembly Wikibook</a></li>
<li><a href="http://csapp.cs.cmu.edu/" target="_blank">Computer Systems: A Programmer&#39;s Perspective</a> (CS:APP)</li>
</ul>
<p>Some of the tools used for reverse engineering can be as complicated as assembly language itself. Cheatsheets that list out common commands and use cases can be helpful.</p>
<ul>
<li><a href="http://www.refcards.com/docs/peschr/gdb/gdb-refcard-a4.pdf" target="_blank">gdb Quick Reference</a></li>
<li><a href="https://www.hex-rays.com/products/ida/support/freefiles/IDA_Pro_Shortcuts.pdf" target="_blank">IDA Quick Reference</a></li>
<li><a href="/vulnerabilities/references/X86_Win32_Reverse_Engineering_Cheat_Sheet.pdf">WinDBG x86 Cheat Sheet</a></li>
</ul>
<p>Finally, many capture the flag challenges will make use of anti-debugging and anti-disassembly techniques to hide or obfuscate the goal. Several of these techniques are employed by the bomb labs but you may want a more complete reference.</p>
<ul>
<li><a href="http://vxheavens.com/lib/vsc04.html" target="_blank">Linux anti-debugging techniques</a></li>
<li><a href="http://pferrie.host22.com/papers/antidebug.pdf" target="_blank">The &quot;Ultimate&quot; Anti-Debugging Reference</a></li>
</ul>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../vulnerabilities/source.html" class="navigation navigation-prev " aria-label="Previous page: Auditing Source"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../web/vulnerabilities.html" class="navigation navigation-next " aria-label="Next page: Auditing Webapps"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"ga":{"token":"UA-37017099-3"}};
    gitbook.start(config);
});
</script>

    </body>
</html>
